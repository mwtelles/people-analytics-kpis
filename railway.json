{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "projectId": "f87cc766-d691-4c74-918d-df5c5f501561",
    "services": [
        {
            "name": "db",
            "build": {
                "builder": "DOCKERFILE",
                "dockerfilePath": "infra/docker/postgres.dockerfile"
            },
            "deploy": {
                "numReplicas": 1,
                "restartPolicyType": "ALWAYS"
            },
            "envs": {
                "POSTGRES_USER": "postgres",
                "POSTGRES_PASSWORD": "postgres",
                "POSTGRES_DB": "people_analytics"
            }
        },
        {
            "name": "backend",
            "build": {
                "builder": "DOCKERFILE",
                "dockerfilePath": "infra/docker/backend.dockerfile"
            },
            "deploy": {
                "preDeployCommand": "npx sequelize-cli db:migrate && npx sequelize-cli db:seed:all",
                "startCommand": "node dist/index.js",
                "numReplicas": 1,
                "restartPolicyType": "ALWAYS",
                "healthcheckPath": "/api/docs"
            },
            "envs": {
                "PORT": "8080",
                "FEATURE_ENTERPRISE": "false",
                "FEATURE_AI": "false",
                "DATABASE_URL": "${{ db.DATABASE_URL }}"
            }
        },
        {
            "name": "frontend",
            "build": {
                "builder": "DOCKERFILE",
                "dockerfilePath": "infra/docker/frontend.dockerfile"
            },
            "deploy": {
                "numReplicas": 1,
                "restartPolicyType": "ALWAYS",
                "healthcheckPath": "/"
            },
            "envs": {
                "PORT": "8080",
                "VITE_API_URL": "https://${{ backend.PUBLIC_URL }}/api"
            }
        }
    ]
}